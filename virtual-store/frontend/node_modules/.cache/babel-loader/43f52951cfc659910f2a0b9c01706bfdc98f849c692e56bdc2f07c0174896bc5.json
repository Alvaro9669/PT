{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ramir\\\\Documents\\\\CodigoPT\\\\PWeb\\\\virtual-store\\\\frontend\\\\src\\\\components\\\\DiscordLoginButton.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport './DiscordLoginButton.css';\nimport CartIcon from './CartIcon'; // Asegúrate de que este componente esté correctamente exportado\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DiscordLoginButton = () => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [showLogout, setShowLogout] = useState(false);\n  const [logoutTimeout, setLogoutTimeout] = useState(null);\n  useEffect(() => {\n    // Validar la autenticación del usuario con el backend\n    const validateUser = async () => {\n      try {\n        const response = await axios.get(`${process.env.REACT_APP_BACKEND_URL}/auth/user`, {\n          withCredentials: true\n        });\n        setUser(response.data); // Actualizar el estado con la información del usuario\n      } catch (error) {\n        if (error.response && error.response.status === 401) {\n          console.warn('User is not authenticated.');\n        }\n        setUser(null); // Asegurarse de que el estado sea null si no está autenticado\n      }\n    };\n    validateUser();\n  }, []); // Ejecutar solo al montar el componente\n\n  const handleLogin = () => {\n    window.location.href = `${process.env.REACT_APP_BACKEND_URL}/auth/login`;\n  };\n  const handleLogout = () => {\n    axios.post(`${process.env.REACT_APP_BACKEND_URL}/auth/logout`, {}, {\n      withCredentials: true\n    }).then(() => {\n      setUser(null);\n      window.location.href = '/'; // Redirigir al home\n    }).catch(err => console.error('Error during logout:', err));\n  };\n  const handleMouseEnter = () => {\n    if (logoutTimeout) {\n      clearTimeout(logoutTimeout);\n      setLogoutTimeout(null);\n    }\n    setShowLogout(true);\n  };\n  const handleMouseLeave = () => {\n    const timeout = setTimeout(() => {\n      setShowLogout(false);\n    }, 1000);\n    setLogoutTimeout(timeout);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"discord-login-container\",\n    children: !user ? /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleLogin,\n      className: \"discord-login-button\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: \"/images/discord.svg\",\n        alt: \"Discord Logo\",\n        className: \"discord-logo\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 21\n      }, this), \"Login with Discord\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-box\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/carrito\",\n          className: \"cart-link\",\n          children: /*#__PURE__*/_jsxDEV(CartIcon, {\n            isLoggedIn: !!user\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info\",\n        onMouseEnter: handleMouseEnter,\n        onMouseLeave: handleMouseLeave,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: user.avatar // Usar directamente la URL del avatar enviada por el back-end\n          ,\n          alt: \"User Avatar\",\n          className: \"user-avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"user-nickname\",\n          children: user.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 25\n        }, this), showLogout && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleLogout,\n          className: \"logout-button\",\n          children: \"Logout\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 9\n  }, this);\n};\n_s(DiscordLoginButton, \"U9UpmlAwWw4XqhCtyqnTRdRRyEA=\");\n_c = DiscordLoginButton;\nexport default DiscordLoginButton;\nvar _c;\n$RefreshReg$(_c, \"DiscordLoginButton\");","map":{"version":3,"names":["React","useState","useEffect","CartIcon","axios","Link","jsxDEV","_jsxDEV","Fragment","_Fragment","DiscordLoginButton","_s","user","setUser","showLogout","setShowLogout","logoutTimeout","setLogoutTimeout","validateUser","response","get","process","env","REACT_APP_BACKEND_URL","withCredentials","data","error","status","console","warn","handleLogin","window","location","href","handleLogout","post","then","catch","err","handleMouseEnter","clearTimeout","handleMouseLeave","timeout","setTimeout","className","children","onClick","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","to","isLoggedIn","onMouseEnter","onMouseLeave","avatar","username","_c","$RefreshReg$"],"sources":["C:/Users/ramir/Documents/CodigoPT/PWeb/virtual-store/frontend/src/components/DiscordLoginButton.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './DiscordLoginButton.css';\nimport CartIcon from './CartIcon'; // Asegúrate de que este componente esté correctamente exportado\nimport axios from 'axios';\nimport { Link } from 'react-router-dom';\n\n\nconst DiscordLoginButton = () => {\n    const [user, setUser] = useState(null);\n    const [showLogout, setShowLogout] = useState(false);\n    const [logoutTimeout, setLogoutTimeout] = useState(null);\n\n    useEffect(() => {\n        // Validar la autenticación del usuario con el backend\n        const validateUser = async () => {\n            try {\n                const response = await axios.get(`${process.env.REACT_APP_BACKEND_URL}/auth/user`, { withCredentials: true });\n                setUser(response.data); // Actualizar el estado con la información del usuario\n            } catch (error) {\n                if (error.response && error.response.status === 401) {\n                    console.warn('User is not authenticated.');\n                }\n                setUser(null); // Asegurarse de que el estado sea null si no está autenticado\n            }\n        };\n\n        validateUser();\n    }, []); // Ejecutar solo al montar el componente\n\n    const handleLogin = () => {\n        window.location.href = `${process.env.REACT_APP_BACKEND_URL}/auth/login`;\n    };\n\n    const handleLogout = () => {\n        axios.post(`${process.env.REACT_APP_BACKEND_URL}/auth/logout`, {}, { withCredentials: true })\n            .then(() => {\n                setUser(null);\n                window.location.href = '/'; // Redirigir al home\n            })\n            .catch(err => console.error('Error during logout:', err));\n    };\n\n    const handleMouseEnter = () => {\n        if (logoutTimeout) {\n            clearTimeout(logoutTimeout);\n            setLogoutTimeout(null);\n        }\n        setShowLogout(true);\n    };\n\n    const handleMouseLeave = () => {\n        const timeout = setTimeout(() => {\n            setShowLogout(false);\n        }, 1000);\n        setLogoutTimeout(timeout);\n    };\n\n    return (\n        <div className=\"discord-login-container\">\n            {!user ? (\n                <button onClick={handleLogin} className=\"discord-login-button\">\n                    <img \n                        src=\"/images/discord.svg\" \n                        alt=\"Discord Logo\" \n                        className=\"discord-logo\" \n                    />\n                    Login with Discord\n                </button>\n            ) : (\n                <>\n                    {/* Caja separada para el carrito */}\n                    <div className=\"cart-box\">\n                        <Link to=\"/carrito\" className=\"cart-link\">\n                            <CartIcon isLoggedIn={!!user} />\n                        </Link>\n                    </div>\n    \n                    {/* Caja separada para la información del usuario */}\n                    <div \n                        className=\"user-info\"\n                        onMouseEnter={handleMouseEnter}\n                        onMouseLeave={handleMouseLeave}\n                    >\n                        <img\n                            src={user.avatar} // Usar directamente la URL del avatar enviada por el back-end\n                            alt=\"User Avatar\"\n                            className=\"user-avatar\"\n                        />\n                        <span className=\"user-nickname\">\n                            {user.username}\n                        </span>\n                        {showLogout && (\n                            <button onClick={handleLogout} className=\"logout-button\">\n                                Logout\n                            </button>\n                        )}\n                    </div>\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default DiscordLoginButton;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}